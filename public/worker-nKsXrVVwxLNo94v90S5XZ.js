console.log("[SW Custom] Loading custom handlers"),self.addEventListener("push",function(n){if(console.log("[SW] üì¨ Push event received:",n),n.data)try{var o;const i=n.data.json();console.log("[SW] Push data:",i);const t=i.title||"ICC WebRadio",e=i.body||"Nouveau contenu disponible",a=i.icon||"/icons/icon-192.png",l=i.badge||"/icons/icon-192.png",c=i.tag||"default",s={body:e,icon:a,badge:l,tag:c,data:{url:i.url||(null===(o=i.data)||void 0===o?void 0:o.url)||"/community"},vibrate:[200,100,200],requireInteraction:null==c?void 0:c.includes("call"),actions:null!=c&&c.includes("call")?[{action:"join",title:"Rejoindre"},{action:"dismiss",title:"Ignorer"}]:[]};n.waitUntil(self.registration.showNotification(t,s))}catch(o){console.error("[SW] Push handler error:",o);try{const o=n.data.text();n.waitUntil(self.registration.showNotification("ICC WebRadio",{body:o,icon:"/icons/icon-192.png"}))}catch(n){console.error("Fallback failed",n)}}else console.warn("[SW] Push event has no data")}),self.addEventListener("notificationclick",function(n){var o;if(console.log("[SW] üñ±Ô∏è Notification clicked:",n.notification.tag,"Action:",n.action),n.notification.close(),"dismiss"===n.action)return;const i=(null===(o=n.notification.data)||void 0===o?void 0:o.url)||"/";n.waitUntil(clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(n){const o=new URL(i,self.location.origin).pathname;for(let i of n)if(i.url.includes(o)&&"focus"in i)return console.log("[SW] Focusing existing window:",i.url),i.focus();if(clients.openWindow)return console.log("[SW] Opening new window:",i),clients.openWindow(i)}))}),self.addEventListener("message",function(n){console.log("[SW] Message received:",n.data),n.data&&"SKIP_WAITING"===n.data.type&&self.skipWaiting()}),console.log("[SW Custom] Handlers registered");